{"mappings":"YAAA,IAAMA,EAAW,YACXC,EAAe,WACfC,EAAgB,YAEhBC,EAAmBC,SAASC,cAAc,2BAyInB,SAApBC,EAAgBC,GACrBA,EAAQC,Q,CAoCZ,SAASC,EAAeC,GACpB,OAAOC,OAAOD,GAAOE,SAAS,EAAG,I,CA8ExB,SAAJC,EAAuBC,GAC5B,IACI,OAAOC,KAAKC,MAAMC,aAAaC,QAAQJ,G,CACzC,MAAOK,GACLC,QAAQC,IAAIF,E,EAYpB,SAASG,EAAuBR,EAAKS,GACjC,IACIN,aAAaO,QAAQV,EAAKC,KAAKU,UAAUF,G,CAC3C,MAAOJ,GACLC,QAAQC,IAAIF,E,EA/QpBhB,EAAiBuB,iBAAiB,SAsBE,SAALC,GAC3B,IAAKA,EAAMC,OAAOC,aAAa,aAAc,OAE7C,IAAMC,EAAOH,EAAMC,OAAOG,QAAQ,gBAE5BC,EAAaL,EAAMC,OAAOK,QAAQC,GAElCC,EAAwBtB,EAAuBX,GAElB,IAA9BiC,EAED,YADAf,QAAQC,IAAI,2BAIhB,IAAMe,EAAQD,EAAsBE,MAAK,SAACC,EAAMC,GAC5C,GAAID,EAAKE,OAASR,EACd,OAAOO,C,IAMS,GAFxBJ,EAAsBM,OAAOL,EAAO,GAEC,IAAjCD,EAAsBO,OAGtB,OAFAzB,aAAa0B,WAAW,kBACxBrC,EAAgBwB,GAIpBR,EAAuBpB,EAAeiC,GAES7B,EAA/BwB,E,IA5Cc,SAAThB,GACrB,IAAMqB,EAAwBtB,EAAuBC,GAET,IAAvCqB,GAA0D,IAAjCA,EAAsBO,OAEJ,YAD5CE,MAAM,uEA8CUC,EA1CLV,EA4CTW,EAAkBD,EAAeE,KAAI,SAAAC,GACvC,IAAQC,EAAuDD,EAAvDC,MAAOC,EAAgDF,EAAhDE,SAAUC,EAAsCH,EAAtCG,KAAMX,EAAgCQ,EAAhCR,KAAMY,EAA0BJ,EAA1BI,YAAaC,EAAaL,EAAbK,SAC5CC,EAAWvC,KAAKU,UAAUuB,GAG5BO,EAAQ,iBAQZ,OANiCA,EAgNzC,SAA0BC,EAAOC,GAC7B,GAAKD,GAA0B,IAAjBA,EAAMd,OAIpB,OADsBc,EAAME,MAAK,SAAAC,G,OAAQA,IAASF,C,IAEvC,iBAEA,gB,CAxNCG,CADqB/C,EAAuBZ,GACLuC,MAE3Ce,EAAQ,kBAIL,+FAEmCM,OADZX,EAAS,2DAQhCW,OAPmCN,EAAM,ksBAc/BM,OAPVR,EAAS,oMAQLQ,OADMP,EAAS,wBAKTO,OAJNrB,EAAK,2GAUGqB,OANFP,EAAS,6IAiBxBO,OAXiBP,EAAS,gvBAc1BO,OAHAZ,EAAM,kFAM4BY,OAHlCT,EAAY,sGAMNS,OAH4BV,EAAK,4EAKxBU,OAFTrB,EAAK,0DAEaqB,OAATP,EAAS,qE,IAM3BQ,KAAK,KAED3D,EAAiB4D,UAAYjB,EAxEf,IAADD,EAEdC,C,CA1D6BkB,CAAvB9D,GA4I2BC,EAA1BuB,iBAAiB,SAKF,SAAPC,GAErB,GADAA,EAAMsC,kBACDtC,EAAMC,OAAOsC,UAAUC,SAAS,0BAA2B,OAE1C,IAAhBC,GAeAjB,EAAO,IAAIkB,KACXC,EAAM7D,EAAe0C,EAAKoB,WAC1BC,EAAQ/D,EAAe0C,EAAKsB,WAAa,GACzCC,EAAOjE,EAAe0C,EAAKwB,eAC1B,GAAUd,OAAPS,EAAI,KAAYT,OAATW,EAAM,KAAQX,OAALa,IAlBpBE,EA2GV,SAAuBC,GACnB,IACI,OAAO9D,KAAKC,MAAM6D,E,CACpB,MAAO1D,GACLC,QAAQC,IAAIF,E,EA/GO2D,CAAcnD,EAAMC,OAAOK,QAAQqB,UACpDyB,EAAuBlE,EAAuBZ,GAC9CkC,EAAwBtB,EAAuBb,GAW7B,IAClBmD,EACAmB,EACAE,EACAE,GAQuC,SAAxBlB,EAAOhB,EAAM1B,GAClC,GAAI0C,EAAO,CAQP,YAP0BA,EAAME,MAAK,SAAAC,G,OAAQA,IAASnB,C,MAGlDgB,EAAMwB,KAAKxC,GACwClB,EAA5BR,EAAK0C,I,CAMpClC,EAAuBR,EAAK,CAAC0B,G,EA/BWyC,CAAxBF,EAAsBH,EAAepC,KAAMvC,GAmCC,SAAvCiF,EAASC,EAAShC,EAAMrC,GAC7C,GAAIoE,EAAS,CAET,IAAME,EAAa,GAWO,GAT1BF,EAAQG,SAAQ,SAAAC,GACZ,IAEMC,EAFgBD,EAAdE,UAEoB9B,MAAK,SAAA+B,G,OAAQA,EAAKjD,OAAS2C,EAAQ3C,I,IAC/B4C,EAArBJ,KAAKO,E,KAGEH,EAAW1B,MAAK,SAAAgC,G,OAAUA,C,IAE5B,CAGiC,GAF5BR,EAAQxB,MAAK,SAAAC,G,OAAQA,EAAKgC,WAAaxC,C,IAE1C,CACd,IAAMyC,EAAmBV,EAAQnC,KAAI,SAAAY,GACjC,IAAQgC,EAAwBhC,EAAxBgC,SAAUH,EAAc7B,EAAd6B,UAClB,GAAIG,IAAaxC,EAEsB,OADnCqC,EAAUR,KAAKG,GACR,CAAEQ,WAAUH,Y,IAKoB,OAF/CpE,QAAQC,IAAIuE,QACZtE,EAAuBR,EAAK8E,E,CAIhC,IAAMC,EAAqB,CACvBF,SAAUxC,EACVqC,UAAW,CAACL,IAGhBD,EAAQF,KAAKa,GAEqDvE,EAA3CR,EAAKoE,E,CAGhC,M,CAGJ,IAAMY,EAAgB,GAChBC,EAAqB,CACvBJ,SAAUxC,EACVqC,UAAW,CAACL,IAGhBW,EAAcd,KAAKe,GAEsCzE,EAAlCR,EAAKgF,E,CAnFYE,CAAxB7D,EAAuByC,EAAgBR,EAAWpE,E","sources":["src/favourite.js"],"sourcesContent":["const READ_KEY = \"HAVE_READ\"; // ключ для массива прочитанных новостей в Локальном Хранилище\nconst READ_URL_KEY = \"READ_URL\"; // ключ для массива URL прочитанных новостей в Локальном Хранилище\nconst FAVORITES_KEY = \"FAVORITES\";// ключ для массива новостей Фавориты в Локальном Хранилище\n\nconst favouriteGallery = document.querySelector(\".js-articles-favourites\");\n\nfavouriteGallery.addEventListener(\"click\", onRemoveFromFavorites); // вешаем слушатель событий на галерею новостей\n\nonOpenFavorites(FAVORITES_KEY); // запуск функции для рендера страницы\n\n\n\n\n//=============== Функция при открытии страныцы \"Фавориты\" ==================================\nfunction onOpenFavorites(key) {\n    const dataFromLocaleStorage = onGetLocaleStorageData(key); // получаем данные из избранных в Локальном Хранилище\n\n    if (!dataFromLocaleStorage || dataFromLocaleStorage.length === 0) { // проверка на null или пустой массив\n        alert(\"Добавьте страницу заглушку пожалуйста. Файл favourite.js, 19-строка\");\n        return;\n    }\n\n    onCreateMurkup(dataFromLocaleStorage);\n\n}\n\n\n//============= Функция-обработчик удаления из Фаворитов ==============================\nfunction onRemoveFromFavorites(event) {\n    if (!event.target.hasAttribute(\"data-info\")) return;\n\n    const card = event.target.closest(\".markup-unit\");\n    \n    const cardIDLink = event.target.dataset.id; // получаем ID карточки в виде линка на первоисточник\n\n    const dataFromLocaleStorage = onGetLocaleStorageData(FAVORITES_KEY); // получаем массив из Локального хранилища\n\n    if (!dataFromLocaleStorage) { // проверка на null из пустого Локального Хранилища \n        console.log(\"News isn't in favorites\");\n        return;\n    };\n\n    const index = dataFromLocaleStorage.find((card, index) => { // получаем индекс нужной карточки\n        if (card.link === cardIDLink) {\n            return index;\n        }\n    });\n\n    dataFromLocaleStorage.splice(index, 1) // удаляем карточку по индексу\n\n    if (dataFromLocaleStorage.length === 0) { // проверяем пустой массив или нет\n        localStorage.removeItem('FAVORITES');\n        onRemoveElement(card);\n        return;\n    }\n\n    onSetLocaleStorageData(FAVORITES_KEY, dataFromLocaleStorage); // сетаем в локальное хранилище модифицированный массив\n\n    onRemoveElement(card);        \n}\n\n\n\n//============= Функция для рендера страницы ===========================================\nfunction onCreateMurkup(arrayOfObjects) { \n\n    const favoritesMurkup = arrayOfObjects.map(newsObject => { // перебираем массив из Локального хранилища и создаем разметку для карточки\n        const { title, category, date, link, description, imageURL } = newsObject;\n        const favorite = JSON.stringify(newsObject);\n\n        //Логика отображения прочитанных на странице Фавориты--------------------------------------\n        let check = \"display: none;\";// стиль по умолчанию для плашки \"Already read\"\n        const urlFromLocaleStorage = onGetLocaleStorageData(READ_URL_KEY); // получаем массив URL прочитанных новостей\n        check = checkIfReadByUrl(urlFromLocaleStorage, link); //возвращает строку с разным свойством display\n        if (!check) { // проверка на undefined\n            check = \"display: none;\"\n        }\n        //---------------------------------------------------------------------\n        \n        return `<li class=\"markup-unit markup-unit__read\" name=\"card\">\n    <p class=\"markup-unit__section\">${category}</p>\n    <p class=\"markup-unit__already-read\" style='${check}'>Already read\n    <svg class=\"markup-unit__icon-check\" width=\"18\" height=\"18\" viewBox=\"0 0 37 32\">\n      <path stroke=\"#00DD73\" stroke-linejoin=\"miter\" stroke-linecap=\"square\" stroke-miterlimit=\"4\" stroke-width=\"2.2857\" d=\"M28.779 6.389c-0.288 0.009-0.546 0.131-0.732 0.323l-16.313 16.313-6.713-6.713c-0.195-0.209-0.473-0.339-0.78-0.339-0.589 0-1.067 0.478-1.067 1.067 0 0.308 0.13 0.585 0.339 0.78l0.001 0.001 7.467 7.467c0.193 0.193 0.459 0.312 0.754 0.312s0.561-0.119 0.754-0.312v0l17.067-17.067c0.199-0.194 0.323-0.465 0.323-0.765 0-0.589-0.478-1.067-1.067-1.067-0.011 0-0.022 0-0.033 0l0.002-0z\"></path>\n    </svg>\n    </p>\n    <img \n        class=\"markup-unit__card-image\" \n        src=\"${imageURL}\" \n        alt=\"placeholder\"\n        />\n    <button \n        class=\"markup-unit__add-favorite js-fbutton js-favorites\" \n        type=\"button\" \n        data-info\n        data-favorite='${favorite}'\n        data-id='${link}'\n      >\n      <p \n        class=\"markup-unit__favorite-text js-fbutton\"\n        data-favorite='${favorite}'\n        style=\"pointer-events: none;\"\n      >\n          Remove from favourites\n      </p>\n      <svg \n          data-favorite='${favorite}'  \n          class=\"markup-unit__favorite-icon markup-unit__favorite-icon--active js-fbutton\" \n          width=\"15\" \n          height=\"15\" \n          viewBox=\"0 0 37 32\"\n          style=\"pointer-events: none;\"\n        >\n        <path style=\"stroke: var(--color1, #4440f7)\" stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"4\" stroke-width=\"2.2857\" d=\"M10.666 2.286c-4.207 0-7.619 3.377-7.619 7.543 0 3.363 1.333 11.345 14.458 19.413 0.235 0.143 0.505 0.219 0.78 0.219s0.545-0.076 0.78-0.219c13.125-8.069 14.458-16.050 14.458-19.413 0-4.166-3.412-7.543-7.619-7.543s-7.619 4.571-7.619 4.571-3.412-4.571-7.619-4.571z\"></path>\n      </svg>\n    </button>\n    <h2 class=\"markup-unit__card-header\" name=\"card_header\">\n        ${title}\n    </h2>\n    <p class=\"markup-unit__card-text\" name=\"card_text\">\n        ${description}\n    </p>\n    <div class=\"markup-unit__card-footer\">\n        <p class=\"markup-unit__card-date\">${date}</p>\n      <a \n        class=\"markup-unit__read-more\" \n        href=\"${link}\" \n        name=\"read_more\"\n        data-favorite='${favorite}'\n      >\n          Read more\n      </a>\n    </div>\n    </li>`;\n    }).join(\" \");\n\n    return favouriteGallery.innerHTML = favoritesMurkup;\n}\n\n\n//============= Функция удаления элементов из ДОМ ======================================\nfunction onRemoveElement(element) {\n    element.remove();\n}\n\n\n// Логика работы с \"Прочитанными\" на странице Фавориты --------------------------------------------------------------------\n\nfavouriteGallery.addEventListener('click', onReadMoreClick); // вешаем слушатель событий на контейнер с новостями\n\n\n\n//============== Функция обработчик по клику на ссылку ReadMore ==============================================\nfunction onReadMoreClick(event) {\n    event.preventDefault();\n    if (!event.target.classList.contains(\"markup-unit__read-more\")) return; // проверяем туда ли тырнули\n    \n    const clickDate = receiveDate(); // получаем дату клика в виде 20/02/2023    \n    const parsedCardData = makeParseJson(event.target.dataset.favorite); // получаем объект данных с карточки которая находится на странице\n    const urlFromLocaleStorage = onGetLocaleStorageData(READ_URL_KEY); // получаем из локального хранилища массив URL прочитанных новстей\n    const dataFromLocaleStorage = onGetLocaleStorageData(READ_KEY); // получаем массив объектов прочитанных новостей из Локального Хранилища\n\n\n//------ Логика для массива ссылок прочитаных новостей\n    addHaveReadLink(urlFromLocaleStorage, parsedCardData.link, READ_URL_KEY)\n\n//------ Логика для массива объектов с датой и новостями    \n    addHaveReadNews(dataFromLocaleStorage, parsedCardData, clickDate, READ_KEY);\n}\n\n//========== Функция получения даты в формате 20/02/2021\nfunction receiveDate() {\n    const date = new Date();\n    const day = addLeadingZero(date.getDate());\n    const month = addLeadingZero(date.getMonth() + 1);\n    const year = addLeadingZero(date.getFullYear());\n    return `${day}/${month}/${year}`;\n}\nfunction addLeadingZero(value) {\n    return String(value).padStart(2, '0');\n}\n\n//========== Функция добавления ссылок на новости в отдельный массив в Locale Storage ============\nfunction addHaveReadLink(array, link, key) {\n    if (array) { // если вернулся массив ссылок\n        const urlPresenceResult = array.some(item => item === link); // ищем есть ли совпадение с link результат\n\n        if (!urlPresenceResult) { // если нету такого URL в массиве прочитанных новостей            \n            array.push(link); //добавляем в массив URL из локального хранилища URL текущей новости\n            onSetLocaleStorageData(key, array); // сетаем в хранилище обновленный массив URL прочитанных новостей\n        }\n\n        return;\n    }  \n\n    onSetLocaleStorageData(key, [link]); // если массива нет, создаем массив и помещаем туда url прочитанной новости и сетаем в Хранилище\n}\n\n//========== Функция добавления объекта прочитанных новостей согласно дате просмотра =============\nfunction addHaveReadNews(newsArr, cardObj, date, key) {\n    if (newsArr) { // если возвращается массив дат с новостями из Локального Хранилища\n        \n        const resultsArr = [];        \n\n        newsArr.forEach(object => {// перебираем все объекты прочитанных новостей с датами из Локального Хранилища\n            const { newsArray } = object;\n            \n            const isPresent = newsArray.some(news => news.link === cardObj.link);// проверяем есть ли новость в коллекции\n            resultsArr.push(isPresent);\n        });\n        \n        const isNewsPresent = resultsArr.some(result => result); // проверка присутствия новости\n\n        if (!isNewsPresent) { // Если новость не присутствует в прочитанных\n            const datePresence = newsArr.some(item => item.whenRead === date); // проверяем есть ли сегодняшняя дата в массиве прочитанных\n            \n            if (datePresence) { // если дата уже присутствует в массиве\n                const arrWithNewObject = newsArr.map(item => { // создаем новый массив перебирая массив из Локального Хранилища\n                    const { whenRead, newsArray } = item;\n                    if (whenRead === date) { //когда совпадение по дате\n                        newsArray.push(cardObj); // пушим в массив новостей объект с карточки\n                        return { whenRead, newsArray };\n                    }\n                });\n                console.log(arrWithNewObject);\n                onSetLocaleStorageData(key, arrWithNewObject);  // сетаем модифицированный массив в локальное хранилище\n                return;\n            }\n\n            const whenHaveReadObject = {  // создаем новый объект с датой когда новость прочитана и массивом прочитанных на эту дату\n                whenRead: date,\n                newsArray: [cardObj]\n            };\n\n            newsArr.push(whenHaveReadObject);// пушим объект с новостью и датой в существующий массив из Локального Хранилища\n\n            onSetLocaleStorageData(key, newsArr); // сетаем новый массив в локальное хранилище\n        }\n\n        return;\n    }\n\n    const haveReadArray = []; // создаем массив который будем сетать в Локальное хранилище\n    const whenHaveReadObject = {  // создаем новый объект с датой когда новость прочитана и массивом прочитанных на эту дату\n        whenRead: date,\n        newsArray: [cardObj]\n    };\n\n    haveReadArray.push(whenHaveReadObject); // пушим в новый массив объект с датой и массивом прочитанных новостей\n\n    onSetLocaleStorageData(key, haveReadArray); // сетаем массив с прочитанными новостями и датой в Локальное Хранилище\n}\n//-----------------------------------------------------------------------------------------------------------------------------------\n\n\n\n//==================== Сервис Функции ===========================================\nfunction onGetLocaleStorageData(key) {\n    try {\n        return JSON.parse(localStorage.getItem(key)); // получаем массив объектов из Локального Хранилища\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nfunction makeParseJson(stringData) {\n    try {\n        return JSON.parse(stringData);\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nfunction onSetLocaleStorageData(key, data) {\n    try {\n        localStorage.setItem(key, JSON.stringify(data));\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nfunction checkIfReadByUrl(array, newsLink) {\n    if (!array || array.length === 0) { // проверка на null или пустой массив\n        return;\n    }\n    const compareResult = array.some(item => item === newsLink);\n    if (compareResult) {\n        return \"display: flex;\";\n    } else {\n        return \"display: none;\"; \n    }\n     \n}"],"names":["$fe988d6f732edd76$var$READ_KEY","$fe988d6f732edd76$var$READ_URL_KEY","$fe988d6f732edd76$var$FAVORITES_KEY","$fe988d6f732edd76$var$favouriteGallery","document","querySelector","$fe988d6f732edd76$var$onRemoveElement","element","remove","$fe988d6f732edd76$var$addLeadingZero","value","String","padStart","$fe988d6f732edd76$var$onGetLocaleStorageData","key","JSON","parse","localStorage","getItem","error","console","log","$fe988d6f732edd76$var$onSetLocaleStorageData","data","setItem","stringify","addEventListener","event","target","hasAttribute","card1","closest","cardIDLink","dataset","id","dataFromLocaleStorage","index1","find","card","index","link","splice","length","removeItem","alert","arrayOfObjects","favoritesMurkup","map","newsObject","title","category","date","description","imageURL","favorite","check","array","newsLink","some","item","$fe988d6f732edd76$var$checkIfReadByUrl","concat","join","innerHTML","$fe988d6f732edd76$var$onOpenFavorites","preventDefault","classList","contains","clickDate","Date","day","getDate","month","getMonth","year","getFullYear","parsedCardData","stringData","$fe988d6f732edd76$var$makeParseJson","urlFromLocaleStorage","push","$fe988d6f732edd76$var$addHaveReadLink","newsArr","cardObj","resultsArr","forEach","object","isPresent","newsArray","news","result","whenRead","arrWithNewObject","whenHaveReadObject","haveReadArray","whenHaveReadObject1","$fe988d6f732edd76$var$addHaveReadNews"],"version":3,"file":"favourite.db55497d.js.map"}